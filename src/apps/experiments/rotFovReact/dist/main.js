(()=>{"use strict";var t={121:(t,e,i)=>{i.d(e,{Z:()=>n}),t=i.hmd(t);const n=function(t){var e,i=t.Symbol;return"function"==typeof i?i.observable?e=i.observable:(e=i("observable"),i.observable=e):e="@@observable",e}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i.g?i.g:t)}},e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n](o,o.exports,i),o.loaded=!0,o.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=Array.isArray;function e(t){var e=typeof t;return"string"===e||"number"===e}function n(t){return null==t}function o(t){return null===t||!1===t||!0===t||void 0===t}function r(t){return"function"==typeof t}function s(t){return"string"==typeof t}function l(t){return null===t}function a(t,e){var i={};if(t)for(var n in t)i[n]=t[n];if(e)for(var o in e)i[o]=e[o];return i}function h(t){return!l(t)&&"object"==typeof t}var c={};function u(t){return t.substr(2).toLowerCase()}function f(t,e){t.appendChild(e)}function d(t,e,i){l(i)?f(t,e):t.insertBefore(e,i)}function p(t,e){t.removeChild(e)}function g(t){for(var e=0;e<t.length;e++)t[e]()}function _(t,e,i){var n=t.children;return 4&i?n.$LI:8192&i?2===t.childFlags?n:n[e?0:n.length-1]:n}function m(t,e){for(var i;t;){if(2033&(i=t.flags))return t.dom;t=_(t,e,i)}return null}function y(t,e){do{var i=t.flags;if(2033&i)return void p(e,t.dom);var n=t.children;if(4&i&&(t=n.$LI),8&i&&(t=n),8192&i){if(2!==t.childFlags){for(var o=0,r=n.length;o<r;++o)y(n[o],e);return}t=n}}while(t)}function v(t,e,i){do{var n=t.flags;if(2033&n)return void d(e,t.dom,i);var o=t.children;if(4&n&&(t=o.$LI),8&n&&(t=o),8192&n){if(2!==t.childFlags){for(var r=0,s=o.length;r<s;++r)v(o[r],e,i);return}t=o}}while(t)}function b(t,e,i){return t.constructor.getDerivedStateFromProps?a(i,t.constructor.getDerivedStateFromProps(e,i)):i}var w={v:!1},x={componentComparator:null,createVNode:null,renderComplete:null};function k(t,e){t.textContent=e}function C(t,e){return h(t)&&t.event===e.event&&t.data===e.data}function S(t,e){for(var i in e)void 0===t[i]&&(t[i]=e[i]);return t}function M(t,e){return!!r(t)&&(t(e),!0)}var E="$";function T(t,e,i,n,o,r,s,l){this.childFlags=t,this.children=e,this.className=i,this.dom=null,this.flags=n,this.key=void 0===o?null:o,this.props=void 0===r?null:r,this.ref=void 0===s?null:s,this.type=l}function P(t,e,i,n,o,r,s,l){var a=void 0===o?1:o,h=new T(a,n,i,t,s,r,l,e);return x.createVNode&&x.createVNode(h),0===a&&$(h,h.children),h}function R(t,e,i,o,r){var s=new T(1,null,null,t=function(t,e){return 12&t?t:e.prototype&&e.prototype.render?4:e.render?32776:8}(t,e),o,function(t,e,i){var o=(32768&t?e.render:e).defaultProps;return n(o)?i:n(i)?a(o,null):S(i,o)}(t,e,i),function(t,e,i){if(4&t)return i;var o=(32768&t?e.render:e).defaultHooks;return n(o)?i:n(i)?o:S(i,o)}(t,e,r),e);return x.createVNode&&x.createVNode(s),s}function I(t,e){return new T(1,n(t)||!0===t||!1===t?"":t,null,16,e,null,null,null)}function O(t,e,i){var n=P(8192,8192,null,t,e,null,i,null);switch(n.childFlags){case 1:n.children=A(),n.childFlags=2;break;case 16:n.children=[I(t)],n.childFlags=4}return n}function U(t){var e=-16385&t.flags,i=t.props;if(14&e&&!l(i)){var n=i;for(var o in i={},n)i[o]=n[o]}return 0==(8192&e)?new T(t.childFlags,t.children,t.className,e,t.key,i,t.ref,t.type):function(t){var e=t.children,i=t.childFlags;return O(2===i?U(e):e.map(U),i,t.key)}(t)}function A(){return I("",null)}function W(i,n,r,a){for(var h=i.length;r<h;r++){var c=i[r];if(!o(c)){var u=a+E+r;if(t(c))W(c,n,0,u);else{if(e(c))c=I(c,u);else{var f=c.key,d=s(f)&&f[0]===E;(81920&c.flags||d)&&(c=U(c)),c.flags|=65536,d?f.substring(0,a.length)!==a&&(c.key=a+f):l(f)?c.key=u:c.key=a+f}n.push(c)}}}}function D(t){switch(t){case"svg":return 32;case"input":return 64;case"select":return 256;case"textarea":return 128;case"$F":return 8192;default:return 1}}function $(i,n){var r,a=1;if(o(n))r=n;else if(e(n))a=16,r=n;else if(t(n)){for(var h=n.length,c=0;c<h;++c){var u=n[c];if(o(u)||t(u)){r=r||n.slice(0,c),W(n,r,c,"");break}if(e(u))(r=r||n.slice(0,c)).push(I(u,E+c));else{var f=u.key,d=(81920&u.flags)>0,p=l(f),g=s(f)&&f[0]===E;d||p||g?(r=r||n.slice(0,c),(d||g)&&(u=U(u)),(p||g)&&(u.key=E+c),r.push(u)):r&&r.push(u),u.flags|=65536}}a=0===(r=r||n).length?1:8}else(r=n).flags|=65536,81920&n.flags&&(r=U(n)),a=2;return i.children=r,i.childFlags=a,i}function N(i){return o(i)||e(i)?I(i,null):t(i)?O(i,0,null):16384&i.flags?U(i):i}var L="http://www.w3.org/1999/xlink",F="http://www.w3.org/XML/1998/namespace",z={"xlink:actuate":L,"xlink:arcrole":L,"xlink:href":L,"xlink:role":L,"xlink:show":L,"xlink:title":L,"xlink:type":L,"xml:base":F,"xml:lang":F,"xml:space":F};function X(t){return{onClick:t,onDblClick:t,onFocusIn:t,onFocusOut:t,onKeyDown:t,onKeyPress:t,onKeyUp:t,onMouseDown:t,onMouseMove:t,onMouseUp:t,onTouchEnd:t,onTouchMove:t,onTouchStart:t}}var j=X(0),B=X(null),H=X(!0);function Y(t,e){var i=e.$EV;return i||(i=e.$EV=X(null)),i[t]||1==++j[t]&&(B[t]=function(t){var e="onClick"===t||"onDblClick"===t?function(t){return function(e){0===e.button?G(e,!0,t,Z(e)):e.stopPropagation()}}(t):function(t){return function(e){G(e,!1,t,Z(e))}}(t);return document.addEventListener(u(t),e),e}(t)),i}function V(t,e){var i=e.$EV;i&&i[t]&&(0==--j[t]&&(document.removeEventListener(u(t),B[t]),B[t]=null),i[t]=null)}function G(t,e,i,n){var o=function(t){return r(t.composedPath)?t.composedPath()[0]:t.target}(t);do{if(e&&o.disabled)return;var s=o.$EV;if(s){var a=s[i];if(a&&(n.dom=o,a.event?a.event(a.data,t):a(t),t.cancelBubble))return}o=o.parentNode}while(!l(o))}function q(){this.cancelBubble=!0,this.immediatePropagationStopped||this.stopImmediatePropagation()}function K(){return this.defaultPrevented}function Q(){return this.cancelBubble}function Z(t){var e={dom:document};return t.isDefaultPrevented=K,t.isPropagationStopped=Q,t.stopPropagation=q,Object.defineProperty(t,"currentTarget",{configurable:!0,get:function(){return e.dom}}),e}function J(t,e,i){if(t[e]){var n=t[e];n.event?n.event(n.data,i):n(i)}else{var o=e.toLowerCase();t[o]&&t[o](i)}}function tt(t,e){var i=function(i){var n=this.$V;if(n){var o=n.props||c,l=n.dom;if(s(t))J(o,t,i);else for(var a=0;a<t.length;++a)J(o,t[a],i);if(r(e)){var h=this.$V,u=h.props||c;e(u,l,!1,h)}}};return Object.defineProperty(i,"wrapped",{configurable:!1,enumerable:!1,value:!0,writable:!1}),i}function et(t,e,i){var n="$"+e,o=t[n];if(o){if(o[1].wrapped)return;t.removeEventListener(o[0],o[1]),t[n]=null}r(i)&&(t.addEventListener(e,i),t[n]=[e,i])}function it(t){return"checkbox"===t||"radio"===t}var nt=tt("onInput",st),ot=tt(["onClick","onChange"],st);function rt(t){t.stopPropagation()}function st(t,e){var i=t.type,o=t.value,r=t.checked,s=t.multiple,l=t.defaultValue,a=!n(o);i&&i!==e.type&&e.setAttribute("type",i),n(s)||s===e.multiple||(e.multiple=s),n(l)||a||(e.defaultValue=l+""),it(i)?(a&&(e.value=o),n(r)||(e.checked=r)):a&&e.value!==o?(e.defaultValue=o,e.value=o):n(r)||(e.checked=r)}function lt(e,i){if("option"===e.type)!function(e,i){var o=e.props||c,r=e.dom;r.value=o.value,o.value===i||t(i)&&-1!==i.indexOf(o.value)?r.selected=!0:n(i)&&n(o.selected)||(r.selected=o.selected||!1)}(e,i);else{var o=e.children,r=e.flags;if(4&r)lt(o.$LI,i);else if(8&r)lt(o,i);else if(2===e.childFlags)lt(o,i);else if(12&e.childFlags)for(var s=0,l=o.length;s<l;++s)lt(o[s],i)}}rt.wrapped=!0;var at=tt("onChange",ht);function ht(t,e,i,o){var r=Boolean(t.multiple);n(t.multiple)||r===e.multiple||(e.multiple=r);var s=t.selectedIndex;if(-1===s&&(e.selectedIndex=-1),1!==o.childFlags){var l=t.value;"number"==typeof s&&s>-1&&e.options[s]&&(l=e.options[s].value),i&&n(l)&&(l=t.defaultValue),lt(o,l)}}var ct,ut,ft=tt("onInput",pt),dt=tt("onChange");function pt(t,e,i){var o=t.value,r=e.value;if(n(o)){if(i){var s=t.defaultValue;n(s)||s===r||(e.defaultValue=s,e.value=s)}}else r!==o&&(e.defaultValue=o,e.value=o)}function gt(t,e,i,n,o,r){64&t?st(n,i):256&t?ht(n,i,o,e):128&t&&pt(n,i,o),r&&(i.$V=e)}function _t(t,e,i){64&t?function(t,e){it(e.type)?(et(t,"change",ot),et(t,"click",rt)):et(t,"input",nt)}(e,i):256&t?function(t){et(t,"change",at)}(e):128&t&&function(t,e){et(t,"input",ft),e.onChange&&et(t,"change",dt)}(e,i)}function mt(t){return t.type&&it(t.type)?!n(t.checked):!n(t.value)}function yt(t){t&&!M(t,null)&&t.current&&(t.current=null)}function vt(t,e,i){t&&(r(t)||void 0!==t.current)&&i.push((function(){M(t,e)||void 0===t.current||(t.current=e)}))}function bt(t,e){wt(t),y(t,e)}function wt(t){var e,i=t.flags,o=t.children;if(481&i){e=t.ref;var s=t.props;yt(e);var a=t.childFlags;if(!l(s))for(var h=Object.keys(s),u=0,f=h.length;u<f;u++){var d=h[u];H[d]&&V(d,t.dom)}12&a?xt(o):2===a&&wt(o)}else o&&(4&i?(r(o.componentWillUnmount)&&o.componentWillUnmount(),yt(t.ref),o.$UN=!0,wt(o.$LI)):8&i?(!n(e=t.ref)&&r(e.onComponentWillUnmount)&&e.onComponentWillUnmount(m(t,!0),t.props||c),wt(o)):1024&i?bt(o,t.ref):8192&i&&12&t.childFlags&&xt(o))}function xt(t){for(var e=0,i=t.length;e<i;++e)wt(t[e])}function kt(t){t.textContent=""}function Ct(t,e,i){xt(i),8192&e.flags?y(e,t):kt(t)}function St(t,e,i,o){var r=t&&t.__html||"",s=e&&e.__html||"";r!==s&&(n(s)||function(t,e){var i=document.createElement("i");return i.innerHTML=e,i.innerHTML===t.innerHTML}(o,s)||(l(i)||(12&i.childFlags?xt(i.children):2===i.childFlags&&wt(i.children),i.children=null,i.childFlags=1),o.innerHTML=s))}function Mt(t,e,i,o,l,a,c){switch(t){case"children":case"childrenType":case"className":case"defaultValue":case"key":case"multiple":case"ref":case"selectedIndex":break;case"autoFocus":o.autofocus=!!i;break;case"allowfullscreen":case"autoplay":case"capture":case"checked":case"controls":case"default":case"disabled":case"hidden":case"indeterminate":case"loop":case"muted":case"novalidate":case"open":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"selected":o[t]=!!i;break;case"defaultChecked":case"value":case"volume":if(a&&"value"===t)break;var f=n(i)?"":i;o[t]!==f&&(o[t]=f);break;case"style":!function(t,e,i){if(n(e))i.removeAttribute("style");else{var o,r,l=i.style;if(s(e))l.cssText=e;else if(n(t)||s(t))for(o in e)r=e[o],l.setProperty(o,r);else{for(o in e)(r=e[o])!==t[o]&&l.setProperty(o,r);for(o in t)n(e[o])&&l.removeProperty(o)}}}(e,i,o);break;case"dangerouslySetInnerHTML":St(e,i,c,o);break;default:H[t]?function(t,e,i,n){if(r(i))Y(t,n)[t]=i;else if(h(i)){if(C(e,i))return;Y(t,n)[t]=i}else V(t,n)}(t,e,i,o):111===t.charCodeAt(0)&&110===t.charCodeAt(1)?function(t,e,i,n){if(h(i)){if(C(e,i))return;i=function(t){var e=t.event;return function(i){e(t.data,i)}}(i)}et(n,u(t),i)}(t,e,i,o):n(i)?o.removeAttribute(t):l&&z[t]?o.setAttributeNS(z[t],t,i):o.setAttribute(t,i)}}function Et(t,e,i){var n=N(t.render(e,t.state,i)),o=i;return r(t.getChildContext)&&(o=a(i,t.getChildContext())),t.$CX=o,n}function Tt(t,e){var i=t.props||c;return 32768&t.flags?t.type.render(i,t.ref,e):t.type(i,e)}function Pt(t,e,i,o,s,a){var h=t.flags|=16384;481&h?function(t,e,i,o,r,s){var a=t.flags,h=t.props,c=t.className,u=t.childFlags,f=t.dom=function(t,e){return e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t)}(t.type,o=o||(32&a)>0),p=t.children;n(c)||""===c||(o?f.setAttribute("class",c):f.className=c);if(16===u)k(f,p);else if(1!==u){var g=o&&"foreignObject"!==t.type;2===u?(16384&p.flags&&(t.children=p=U(p)),Pt(p,f,i,g,null,s)):8!==u&&4!==u||It(p,f,i,g,null,s)}l(e)||d(e,f,r);l(h)||function(t,e,i,n,o){var r=!1,s=(448&e)>0;for(var l in s&&(r=mt(i))&&_t(e,n,i),i)Mt(l,null,i[l],n,o,r,null);s&&gt(e,t,n,i,!0,r)}(t,a,h,f,o);vt(t.ref,f,s)}(t,e,i,o,s,a):4&h?function(t,e,i,n,o,s){var a=function(t,e,i,n,o,s){var a=new e(i,n),h=a.$N=Boolean(e.getDerivedStateFromProps||a.getSnapshotBeforeUpdate);if(a.$SVG=o,a.$L=s,t.children=a,a.$BS=!1,a.context=n,a.props===c&&(a.props=i),h)a.state=b(a,i,a.state);else if(r(a.componentWillMount)){a.$BR=!0,a.componentWillMount();var u=a.$PS;if(!l(u)){var f=a.state;if(l(f))a.state=u;else for(var d in u)f[d]=u[d];a.$PS=null}a.$BR=!1}return a.$LI=Et(a,i,n),a}(t,t.type,t.props||c,i,n,s);Pt(a.$LI,e,a.$CX,n,o,s),function(t,e,i){vt(t,e,i),r(e.componentDidMount)&&i.push(function(t){return function(){t.componentDidMount()}}(e))}(t.ref,a,s)}(t,e,i,o,s,a):8&h?(function(t,e,i,n,o,r){Pt(t.children=N(Tt(t,i)),e,i,n,o,r)}(t,e,i,o,s,a),function(t,e){var i=t.ref;n(i)||(M(i.onComponentWillMount,t.props||c),r(i.onComponentDidMount)&&e.push(function(t,e){return function(){t.onComponentDidMount(m(e,!0),e.props||c)}}(i,t)))}(t,a)):512&h||16&h?Rt(t,e,s):8192&h?function(t,e,i,n,o,r){var s=t.children,l=t.childFlags;12&l&&0===s.length&&(l=t.childFlags=2,s=t.children=A());2===l?Pt(s,i,o,n,o,r):It(s,i,e,n,o,r)}(t,i,e,o,s,a):1024&h&&function(t,e,i,n,o){Pt(t.children,t.ref,e,!1,null,o);var r=A();Rt(r,i,n),t.dom=r.dom}(t,i,e,s,a)}function Rt(t,e,i){var n=t.dom=document.createTextNode(t.children);l(e)||d(e,n,i)}function It(t,e,i,n,o,r){for(var s=0;s<t.length;++s){var l=t[s];16384&l.flags&&(t[s]=l=U(l)),Pt(l,e,i,n,o,r)}}function Ot(t,e,i,s,h,u,d){var g=e.flags|=16384;t.flags!==g||t.type!==e.type||t.key!==e.key||2048&g?16384&t.flags?function(t,e,i,n,o,r){wt(t),0!=(e.flags&t.flags&2033)?(Pt(e,null,n,o,null,r),function(t,e,i){t.replaceChild(e,i)}(i,e.dom,t.dom)):(Pt(e,i,n,o,m(t,!0),r),y(t,i))}(t,e,i,s,h,d):Pt(e,i,s,h,u,d):481&g?function(t,e,i,o,r,s){var l,a=e.dom=t.dom,h=t.props,u=e.props,f=!1,d=!1;if(o=o||(32&r)>0,h!==u){var p=h||c;if((l=u||c)!==c)for(var g in(f=(448&r)>0)&&(d=mt(l)),l){var _=p[g],m=l[g];_!==m&&Mt(g,_,m,a,o,d,t)}if(p!==c)for(var y in p)n(l[y])&&!n(p[y])&&Mt(y,p[y],null,a,o,d,t)}var v=e.children,b=e.className;t.className!==b&&(n(b)?a.removeAttribute("class"):o?a.setAttribute("class",b):a.className=b);4096&r?function(t,e){t.textContent!==e&&(t.textContent=e)}(a,v):Ut(t.childFlags,e.childFlags,t.children,v,a,i,o&&"foreignObject"!==e.type,null,t,s);f&&gt(r,e,a,l,!1,d);var w=e.ref,x=t.ref;x!==w&&(yt(x),vt(w,a,s))}(t,e,s,h,g,d):4&g?function(t,e,i,n,o,s,h){var u=e.children=t.children;if(l(u))return;u.$L=h;var f=e.props||c,d=e.ref,p=t.ref,g=u.state;if(!u.$N){if(r(u.componentWillReceiveProps)){if(u.$BR=!0,u.componentWillReceiveProps(f,n),u.$UN)return;u.$BR=!1}l(u.$PS)||(g=a(g,u.$PS),u.$PS=null)}At(u,g,f,i,n,o,!1,s,h),p!==d&&(yt(p),vt(d,u,h))}(t,e,i,s,h,u,d):8&g?function(t,e,i,o,s,l,a){var h=!0,u=e.props||c,f=e.ref,d=t.props,p=!n(f),g=t.children;p&&r(f.onComponentShouldUpdate)&&(h=f.onComponentShouldUpdate(d,u));if(!1!==h){p&&r(f.onComponentWillUpdate)&&f.onComponentWillUpdate(d,u);var _=N(Tt(e,o));Ot(g,_,i,o,s,l,a),e.children=_,p&&r(f.onComponentDidUpdate)&&f.onComponentDidUpdate(d,u)}else e.children=g}(t,e,i,s,h,u,d):16&g?function(t,e){var i=e.children,n=e.dom=t.dom;i!==t.children&&(n.nodeValue=i)}(t,e):512&g?e.dom=t.dom:8192&g?function(t,e,i,n,o,r){var s=t.children,l=e.children,a=t.childFlags,h=e.childFlags,c=null;12&h&&0===l.length&&(h=e.childFlags=2,l=e.children=A());var u=0!=(2&h);if(12&a){var f=s.length;(8&a&&8&h||u||!u&&l.length>f)&&(c=m(s[f-1],!1).nextSibling)}Ut(a,h,s,l,i,n,o,c,t,r)}(t,e,i,s,h,d):function(t,e,i,n){var r=t.ref,s=e.ref,l=e.children;if(Ut(t.childFlags,e.childFlags,t.children,l,r,i,!1,null,t,n),e.dom=t.dom,r!==s&&!o(l)){var a=l.dom;p(r,a),f(s,a)}}(t,e,s,d)}function Ut(t,e,i,n,o,r,s,l,a,h){switch(t){case 2:switch(e){case 2:Ot(i,n,o,r,s,l,h);break;case 1:bt(i,o);break;case 16:wt(i),k(o,n);break;default:!function(t,e,i,n,o,r){wt(t),It(e,i,n,o,m(t,!0),r),y(t,i)}(i,n,o,r,s,h)}break;case 1:switch(e){case 2:Pt(n,o,r,s,l,h);break;case 1:break;case 16:k(o,n);break;default:It(n,o,r,s,l,h)}break;case 16:switch(e){case 16:!function(t,e,i){t!==e&&(""!==t?i.firstChild.nodeValue=e:k(i,e))}(i,n,o);break;case 2:kt(o),Pt(n,o,r,s,l,h);break;case 1:kt(o);break;default:kt(o),It(n,o,r,s,l,h)}break;default:switch(e){case 16:xt(i),k(o,n);break;case 2:Ct(o,a,i),Pt(n,o,r,s,l,h);break;case 1:Ct(o,a,i);break;default:var c=0|i.length,u=0|n.length;0===c?u>0&&It(n,o,r,s,l,h):0===u?Ct(o,a,i):8===e&&8===t?function(t,e,i,n,o,r,s,l,a,h){var c,u,f=r-1,d=s-1,p=0,g=t[p],_=e[p];t:{for(;g.key===_.key;){if(16384&_.flags&&(e[p]=_=U(_)),Ot(g,_,i,n,o,l,h),t[p]=_,++p>f||p>d)break t;g=t[p],_=e[p]}for(g=t[f],_=e[d];g.key===_.key;){if(16384&_.flags&&(e[d]=_=U(_)),Ot(g,_,i,n,o,l,h),t[f]=_,d--,p>--f||p>d)break t;g=t[f],_=e[d]}}if(p>f){if(p<=d)for(u=(c=d+1)<s?m(e[c],!0):l;p<=d;)16384&(_=e[p]).flags&&(e[p]=_=U(_)),++p,Pt(_,i,n,o,u,h)}else if(p>d)for(;p<=f;)bt(t[p++],i);else!function(t,e,i,n,o,r,s,l,a,h,c,u,f){var d,p,g,_=0,y=l,b=l,w=r-l+1,x=s-l+1,k=new Int32Array(x+1),C=w===n,S=!1,M=0,E=0;if(o<4||(w|x)<32)for(_=y;_<=r;++_)if(d=t[_],E<x){for(l=b;l<=s;l++)if(p=e[l],d.key===p.key){if(k[l-b]=_+1,C)for(C=!1;y<_;)bt(t[y++],a);M>l?S=!0:M=l,16384&p.flags&&(e[l]=p=U(p)),Ot(d,p,a,i,h,c,f),++E;break}!C&&l>s&&bt(d,a)}else C||bt(d,a);else{var T={};for(_=b;_<=s;++_)T[e[_].key]=_;for(_=y;_<=r;++_)if(d=t[_],E<x)if(void 0!==(l=T[d.key])){if(C)for(C=!1;_>y;)bt(t[y++],a);k[l-b]=_+1,M>l?S=!0:M=l,16384&(p=e[l]).flags&&(e[l]=p=U(p)),Ot(d,p,a,i,h,c,f),++E}else C||bt(d,a);else C||bt(d,a)}if(C)Ct(a,u,t),It(e,a,i,h,c,f);else if(S){var P=function(t){var e=0,i=0,n=0,o=0,r=0,s=0,l=0,a=t.length;a>Wt&&(Wt=a,ct=new Int32Array(a),ut=new Int32Array(a));for(;i<a;++i)if(0!==(e=t[i])){if(t[n=ct[o]]<e){ut[i]=n,ct[++o]=i;continue}for(r=0,s=o;r<s;)t[ct[l=r+s>>1]]<e?r=l+1:s=l;e<t[ct[r]]&&(r>0&&(ut[i]=ct[r-1]),ct[r]=i)}r=o+1;var h=new Int32Array(r);s=ct[r-1];for(;r-- >0;)h[r]=s,s=ut[s],ct[r]=0;return h}(k);for(l=P.length-1,_=x-1;_>=0;_--)0===k[_]?(16384&(p=e[M=_+b]).flags&&(e[M]=p=U(p)),Pt(p,a,i,h,(g=M+1)<o?m(e[g],!0):c,f)):l<0||_!==P[l]?v(p=e[M=_+b],a,(g=M+1)<o?m(e[g],!0):c):l--}else if(E!==x)for(_=x-1;_>=0;_--)0===k[_]&&(16384&(p=e[M=_+b]).flags&&(e[M]=p=U(p)),Pt(p,a,i,h,(g=M+1)<o?m(e[g],!0):c,f))}(t,e,n,r,s,f,d,p,i,o,l,a,h)}(i,n,o,r,s,c,u,l,a,h):function(t,e,i,n,o,r,s,l,a){for(var h,c,u=r>s?s:r,f=0;f<u;++f)h=e[f],c=t[f],16384&h.flags&&(h=e[f]=U(h)),Ot(c,h,i,n,o,l,a),t[f]=h;if(r<s)for(f=u;f<s;++f)16384&(h=e[f]).flags&&(h=e[f]=U(h)),Pt(h,i,n,o,l,a);else if(r>s)for(f=u;f<r;++f)bt(t[f],i)}(i,n,o,r,s,c,u,l,h)}}}function At(t,e,i,n,o,s,l,h,c){var u=t.state,f=t.props,d=Boolean(t.$N),p=r(t.shouldComponentUpdate);if(d&&(e=b(t,i,e!==u?a(u,e):e)),l||!p||p&&t.shouldComponentUpdate(i,e,o)){!d&&r(t.componentWillUpdate)&&t.componentWillUpdate(i,e,o),t.props=i,t.state=e,t.context=o;var g=null,_=Et(t,i,o);d&&r(t.getSnapshotBeforeUpdate)&&(g=t.getSnapshotBeforeUpdate(f,u)),Ot(t.$LI,_,n,t.$CX,s,h,c),t.$LI=_,r(t.componentDidUpdate)&&function(t,e,i,n,o){o.push((function(){t.componentDidUpdate(e,i,n)}))}(t,f,u,g,c)}else t.props=i,t.state=e,t.context=o}var Wt=0;function Dt(t,e,i,o){void 0===i&&(i=null),void 0===o&&(o=c),function(t,e,i,o){var s=[],l=e.$V;w.v=!0,n(l)?n(t)||(16384&t.flags&&(t=U(t)),Pt(t,e,o,!1,null,s),e.$V=t,l=t):n(t)?(bt(l,e),e.$V=null):(16384&t.flags&&(t=U(t)),Ot(l,t,e,o,!1,null,s),l=e.$V=t),g(s),w.v=!1,r(i)&&i(),r(x.renderComplete)&&x.renderComplete(l,e)}(t,e,i,o)}"undefined"!=typeof document&&window.Node&&(Node.prototype.$EV=null,Node.prototype.$V=null);var $t=[],Nt="undefined"!=typeof Promise?Promise.resolve().then.bind(Promise.resolve()):function(t){window.setTimeout(t,0)},Lt=!1;function Ft(t,e,i,o){var s=t.$PS;if(r(e)&&(e=e(s?a(t.state,s):t.state,t.props,t.context)),n(s))t.$PS=e;else for(var l in e)s[l]=e[l];if(t.$BR)r(i)&&t.$L.push(i.bind(t));else{if(!w.v&&0===$t.length)return jt(t,o),void(r(i)&&i.call(t));if(-1===$t.indexOf(t)&&$t.push(t),o&&(t.$F=!0),Lt||(Lt=!0,Nt(Xt)),r(i)){var h=t.$QU;h||(h=t.$QU=[]),h.push(i)}}}function zt(t){for(var e=t.$QU,i=0;i<e.length;++i)e[i].call(t);t.$QU=null}function Xt(){var t;for(Lt=!1;t=$t.shift();)if(!t.$UN){var e=t.$F;t.$F=!1,jt(t,e),t.$QU&&zt(t)}}function jt(t,e){if(e||!t.$BR){var i=t.$PS;t.$PS=null;var n=[];w.v=!0,At(t,a(t.state,i),t.props,m(t.$LI,!0).parentNode,t.context,t.$SVG,e,null,n),g(n),w.v=!1}else t.state=t.$PS,t.$PS=null}var Bt=function(t,e){this.state=null,this.$BR=!1,this.$BS=!0,this.$PS=null,this.$LI=null,this.$UN=!1,this.$CX=null,this.$QU=null,this.$N=!1,this.$L=null,this.$SVG=!1,this.$F=!1,this.props=t||c,this.context=e||c};Bt.prototype.forceUpdate=function(t){this.$UN||Ft(this,{},t,!0)},Bt.prototype.setState=function(t,e){this.$UN||this.$BS||Ft(this,t,e,!1)},Bt.prototype.render=function(t,e,i){return null};function Ht(t){return null==t}function Yt(t){return"string"==typeof t}function Vt(t){return void 0===t}var Gt={onComponentDidMount:1,onComponentDidUpdate:1,onComponentShouldUpdate:1,onComponentWillMount:1,onComponentWillUnmount:1,onComponentWillUpdate:1};function qt(t,e,i){var n,o,r=arguments,s=null,l=null,a=null,h=0,c=arguments.length-2;if(1===c)n=i;else if(c>1)for(n=[];c-- >0;)n[c]=r[c+2];if(!Yt(t)){if(h=2,Vt(n)||(e||(e={}),e.children=n),!Ht(e))for(var u in o={},e)"key"===u?l=e.key:"ref"===u?s=e.ref:1===Gt[u]?(s||(s={}),s[u]=e[u]):o[u]=e[u];return R(h,t,o,l,s)}if(h=D(t),!Ht(e))for(var f in o={},e)"className"===f||"class"===f?a=e[f]:"key"===f?l=e.key:"children"===f&&Vt(n)?n=e.children:"ref"===f?s=e.ref:("contenteditable"===f&&(h|=4096),o[f]=e[f]);return 8192&h?O(1===c?[n]:n,0,l):P(h,t,a,n,0,o,l,s)}var Kt=i(121),Qt=function(){return Math.random().toString(36).substring(7).split("").join(".")},Zt={INIT:"@@redux/INIT"+Qt(),REPLACE:"@@redux/REPLACE"+Qt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Qt()}};function Jt(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function te(t,e,i){var n;if("function"==typeof e&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof e&&void 0===i&&(i=e,e=void 0),void 0!==i){if("function"!=typeof i)throw new Error("Expected the enhancer to be a function.");return i(te)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var o=t,r=e,s=[],l=s,a=!1;function h(){l===s&&(l=s.slice())}function c(){if(a)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return r}function u(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(a)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var e=!0;return h(),l.push(t),function(){if(e){if(a)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");e=!1,h();var i=l.indexOf(t);l.splice(i,1),s=null}}}function f(t){if(!Jt(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(a)throw new Error("Reducers may not dispatch actions.");try{a=!0,r=o(r,t)}finally{a=!1}for(var e=s=l,i=0;i<e.length;i++){(0,e[i])()}return t}function d(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");o=t,f({type:Zt.REPLACE})}function p(){var t,e=u;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function i(){t.next&&t.next(c())}return i(),{unsubscribe:e(i)}}})[Kt.Z]=function(){return this},t}return f({type:Zt.INIT}),(n={dispatch:f,subscribe:u,getState:c,replaceReducer:d})[Kt.Z]=p,n}var ee="ADD_SANDWICH",ie="CHANGE_GRATUITY",ne="CHANGE_SANDWICH_NAME",oe="CHANGE_STAGED_SANDWICH_NAME",re="NEW_ORDER",se="POP_INGREDIENT",le="PUSH_INGREDIENT",ae="REMOVE_SANDWICH",he="SELECT_INGREDIENT_TO_PUSH",ce="INITIALIZE",ue="COMPLETE_ORDER";function fe(t){return function(t){if(Array.isArray(t))return de(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return de(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return de(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function pe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ge(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(i),!0).forEach((function(e){_e(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):pe(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function _e(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const me=2.3283064365386963e-10;class ye{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(t){return t=t<1?1/t:t,this._seed=t,this._s0=(t>>>0)*me,t=69069*t+1>>>0,this._s1=t*me,t=69069*t+1>>>0,this._s2=t*me,this._c=1,this}getUniform(){let t=2091639*this._s0+this._c*me;return this._s0=this._s1,this._s1=this._s2,this._c=0|t,this._s2=t-this._c,this._s2}getUniformInt(t,e){let i=Math.max(t,e),n=Math.min(t,e);return Math.floor(this.getUniform()*(i-n+1))+n}getNormal(t=0,e=1){let i,n,o;do{i=2*this.getUniform()-1,n=2*this.getUniform()-1,o=i*i+n*n}while(o>1||0==o);return t+i*Math.sqrt(-2*Math.log(o)/o)*e}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(t){return t.length?t[Math.floor(this.getUniform()*t.length)]:null}shuffle(t){let e=[],i=t.slice();for(;i.length;){let t=i.indexOf(this.getItem(i));e.push(i.splice(t,1)[0])}return e}getWeightedValue(t){let e=0;for(let i in t)e+=t[i];let i,n=this.getUniform()*e,o=0;for(i in t)if(o+=t[i],n<o)return i;return i}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(t){return this._s0=t[0],this._s1=t[1],this._s2=t[2],this._c=t[3],this}clone(){return(new ye).setState(this.getState())}}const ve=(new ye).setSeed(Date.now());class be{getContainer(){return null}setOptions(t){this._options=t}}class we extends be{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}schedule(t){requestAnimationFrame(t)}getContainer(){return this._ctx.canvas}setOptions(t){super.setOptions(t);const e=`${t.fontStyle?`${t.fontStyle} `:""} ${t.fontSize}px ${t.fontFamily}`;this._ctx.font=e,this._updateSize(),this._ctx.font=e,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}eventToPosition(t,e){let i=this._ctx.canvas,n=i.getBoundingClientRect();return t-=n.left,e-=n.top,t*=i.width/n.width,e*=i.height/n.height,t<0||e<0||t>=i.width||e>=i.height?[-1,-1]:this._normalizedEventToPosition(t,e)}}function xe(t,e){return(t%e+e)%e}class ke extends we{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(t,e){let[i,n,o,r,s]=t,l=[(i+1)*this._spacingX,n*this._spacingY+this._hexSize];if(this._options.transpose&&l.reverse(),e&&(this._ctx.fillStyle=s,this._fill(l[0],l[1])),!o)return;this._ctx.fillStyle=r;let a=[].concat(o);for(let t=0;t<a.length;t++)this._ctx.fillText(a[t],l[0],Math.ceil(l[1]))}computeSize(t,e){return this._options.transpose&&(t+=e,t-=e=t-e),[Math.floor(t/this._spacingX)-1,Math.floor((e-2*this._hexSize)/this._spacingY+1)]}computeFontSize(t,e){this._options.transpose&&(t+=e,t-=e=t-e);let i=2*t/((this._options.width+1)*Math.sqrt(3))-1,n=e/(2+1.5*(this._options.height-1)),o=Math.min(i,n),r=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let s=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=r;let l=s/100;o=Math.floor(o)+1;let a=2*o/(this._options.spacing*(1+l/Math.sqrt(3)));return Math.ceil(a)-1}_normalizedEventToPosition(t,e){let i;this._options.transpose?(t+=e,t-=e=t-e,i=this._ctx.canvas.width):i=this._ctx.canvas.height;let n=i/this._options.height;return xe(e=Math.floor(e/n),2)?(t-=this._spacingX,t=1+2*Math.floor(t/(2*this._spacingX))):t=2*Math.floor(t/(2*this._spacingX)),[t,e]}_fill(t,e){let i=this._hexSize,n=this._options.border;const o=this._ctx;o.beginPath(),this._options.transpose?(o.moveTo(t-i+n,e),o.lineTo(t-i/2+n,e+this._spacingX-n),o.lineTo(t+i/2-n,e+this._spacingX-n),o.lineTo(t+i-n,e),o.lineTo(t+i/2-n,e-this._spacingX+n),o.lineTo(t-i/2+n,e-this._spacingX+n),o.lineTo(t-i+n,e)):(o.moveTo(t,e-i+n),o.lineTo(t+this._spacingX-n,e-i/2+n),o.lineTo(t+this._spacingX-n,e+i/2-n),o.lineTo(t,e+i-n),o.lineTo(t-this._spacingX+n,e+i/2-n),o.lineTo(t-this._spacingX+n,e-i/2+n),o.lineTo(t,e-i+n)),o.fill()}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);let i,n;this._hexSize=Math.floor(t.spacing*(t.fontSize+e/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,t.transpose?(i="height",n="width"):(i="width",n="height"),this._ctx.canvas[i]=Math.ceil((t.width+1)*this._spacingX),this._ctx.canvas[n]=Math.ceil((t.height-1)*this._spacingY+2*this._hexSize)}}const Ce=(()=>{class t extends we{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(t){super.setOptions(t),this._canvasCache={}}draw(e,i){t.cache?this._drawWithCache(e):this._drawNoCache(e,i)}_drawWithCache(t){let e,[i,n,o,r,s]=t,l=""+o+r+s;if(l in this._canvasCache)e=this._canvasCache[l];else{let t=this._options.border;e=document.createElement("canvas");let i=e.getContext("2d");if(e.width=this._spacingX,e.height=this._spacingY,i.fillStyle=s,i.fillRect(t,t,e.width-t,e.height-t),o){i.fillStyle=r,i.font=this._ctx.font,i.textAlign="center",i.textBaseline="middle";let t=[].concat(o);for(let e=0;e<t.length;e++)i.fillText(t[e],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[l]=e}this._ctx.drawImage(e,i*this._spacingX,n*this._spacingY)}_drawNoCache(t,e){let[i,n,o,r,s]=t;if(e){let t=this._options.border;this._ctx.fillStyle=s,this._ctx.fillRect(i*this._spacingX+t,n*this._spacingY+t,this._spacingX-t,this._spacingY-t)}if(!o)return;this._ctx.fillStyle=r;let l=[].concat(o);for(let t=0;t<l.length;t++)this._ctx.fillText(l[t],(i+.5)*this._spacingX,Math.ceil((n+.5)*this._spacingY))}computeSize(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}computeFontSize(t,e){let i=Math.floor(t/this._options.width),n=Math.floor(e/this._options.height),o=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let r=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=o;let s=r/100*n/i;return s>1&&(n=Math.floor(n/s)),Math.floor(n/this._options.spacing)}_normalizedEventToPosition(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(t.spacing*e),this._spacingY=Math.ceil(t.spacing*t.fontSize),t.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=t.width*this._spacingX,this._ctx.canvas.height=t.height*this._spacingY}}return t.cache=!1,t})();class Se extends we{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(t,e){let[i,n,o,r,s]=t,l=this._options.tileWidth,a=this._options.tileHeight;if(e&&(this._options.tileColorize?this._ctx.clearRect(i*l,n*a,l,a):(this._ctx.fillStyle=s,this._ctx.fillRect(i*l,n*a,l,a))),!o)return;let h=[].concat(o),c=[].concat(r),u=[].concat(s);for(let t=0;t<h.length;t++){let e=this._options.tileMap[h[t]];if(!e)throw new Error(`Char "${h[t]}" not found in tileMap`);if(this._options.tileColorize){let o=this._colorCanvas,r=o.getContext("2d");r.globalCompositeOperation="source-over",r.clearRect(0,0,l,a);let s=c[t],h=u[t];r.drawImage(this._options.tileSet,e[0],e[1],l,a,0,0,l,a),"transparent"!=s&&(r.fillStyle=s,r.globalCompositeOperation="source-atop",r.fillRect(0,0,l,a)),"transparent"!=h&&(r.fillStyle=h,r.globalCompositeOperation="destination-over",r.fillRect(0,0,l,a)),this._ctx.drawImage(o,i*l,n*a,l,a)}else this._ctx.drawImage(this._options.tileSet,e[0],e[1],l,a,i*l,n*a,l,a)}}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._options;this._ctx.canvas.width=t.width*t.tileWidth,this._ctx.canvas.height=t.height*t.tileHeight,this._colorCanvas.width=t.tileWidth,this._colorCanvas.height=t.tileHeight}}function Me(t){let e,i;if(t in Ee)e=Ee[t];else{if("#"==t.charAt(0)){let i=(t.match(/[0-9a-f]/gi)||[]).map((t=>parseInt(t,16)));if(3==i.length)e=i.map((t=>17*t));else{for(let t=0;t<3;t++)i[t+1]+=16*i[t],i.splice(t,1);e=i}}else e=(i=t.match(/rgb\(([0-9, ]+)\)/i))?i[1].split(/\s*,\s*/).map((t=>parseInt(t))):[0,0,0];Ee[t]=e}return e.slice()}const Ee={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]};class Te extends be{constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(t){alert(t.message)}}static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}schedule(t){requestAnimationFrame(t)}getContainer(){return this._gl.canvas}setOptions(t){super.setOptions(t),this._updateSize();let e=this._options.tileSet;e&&"complete"in e&&!e.complete?e.addEventListener("load",(()=>this._updateTexture(e))):this._updateTexture(e)}draw(t,e){const i=this._gl,n=this._options;let[o,r,s,l,a]=t,h=i.canvas.height-(r+1)*n.tileHeight;if(i.scissor(o*n.tileWidth,h,n.tileWidth,n.tileHeight),e&&(n.tileColorize?i.clearColor(0,0,0,0):i.clearColor(...Ue(a)),i.clear(i.COLOR_BUFFER_BIT)),!s)return;let c=[].concat(s),u=[].concat(a),f=[].concat(l);i.uniform2fv(this._uniforms.targetPosRel,[o,r]);for(let t=0;t<c.length;t++){let e=this._options.tileMap[c[t]];if(!e)throw new Error(`Char "${c[t]}" not found in tileMap`);i.uniform1f(this._uniforms.colorize,n.tileColorize?1:0),i.uniform2fv(this._uniforms.tilesetPosAbs,e),n.tileColorize&&(i.uniform4fv(this._uniforms.tint,Ue(f[t])),i.uniform4fv(this._uniforms.bg,Ue(u[t]))),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}clear(){const t=this._gl;t.clearColor(...Ue(this._options.bg)),t.scissor(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}eventToPosition(t,e){let i=this._gl.canvas,n=i.getBoundingClientRect();return t-=n.left,e-=n.top,t*=i.width/n.width,e*=i.height/n.height,t<0||e<0||t>=i.width||e>=i.height?[-1,-1]:this._normalizedEventToPosition(t,e)}_initWebGL(){let t=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=t;let e=function(t,e,i){const n=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n)||"");const o=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(o,i),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(o)||"");const r=t.createProgram();if(t.attachShader(r,n),t.attachShader(r,o),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(r)||"");return r}(t,Re,Ie);return t.useProgram(e),function(t){const e=new Float32Array([0,0,1,0,0,1,1,1]),i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0)}(t),Pe.forEach((i=>this._uniforms[i]=t.getUniformLocation(e,i))),this._program=e,t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.SCISSOR_TEST),t}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._gl,e=this._options,i=[e.width*e.tileWidth,e.height*e.tileHeight];t.canvas.width=i[0],t.canvas.height=i[1],t.viewport(0,0,i[0],i[1]),t.uniform2fv(this._uniforms.tileSize,[e.tileWidth,e.tileHeight]),t.uniform2fv(this._uniforms.targetSize,i)}_updateTexture(t){!function(t,e){let i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}(this._gl,t)}}const Pe=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],Re="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),Ie="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();let Oe={};function Ue(t){if(!(t in Oe)){let e;if("transparent"==t)e=[0,0,0,0];else if(t.indexOf("rgba")>-1){e=(t.match(/[\d.]+/g)||[]).map(Number);for(let t=0;t<3;t++)e[t]=e[t]/255}else e=Me(t).map((t=>t/255)),e.push(1);Oe[t]=e}return Oe[t]}function Ae(t){const e=6/256;let i=Me(t);return 36*Math.floor(i[0]*e)+6*Math.floor(i[1]*e)+1*Math.floor(i[2]*e)+16}class We extends be{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}schedule(t){setTimeout(t,1e3/60)}setOptions(t){super.setOptions(t);let e=[t.width,t.height],i=this.computeSize();this._offset=i.map(((t,i)=>Math.floor((t-e[i])/2)))}clear(){process.stdout.write(`[0;48;5;${Ae(this._options.bg)}m[2J`)}draw(t,e){let[i,n,o,r,s]=t,l=this._offset[0]+i,a=this._offset[1]+n,h=this.computeSize();if(l<0||l>=h[0])return;if(a<0||a>=h[1])return;if(l===this._cursor[0]&&a===this._cursor[1]||(process.stdout.write(function(t,e){return`[${e+1};${t+1}H`}(l,a)),this._cursor[0]=l,this._cursor[1]=a),e&&(o||(o=" ")),!o)return;let c=function(t,e){return`[0;38;5;${Ae(t)};48;5;${Ae(e)}m`}(r,s);if(c!==this._lastColor&&(process.stdout.write(c),this._lastColor=c),"\t"!=o){let t=[].concat(o);process.stdout.write(t[0])}this._cursor[0]++,this._cursor[0]>=h[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw new Error("Terminal backend has no notion of font size")}eventToPosition(t,e){return[t,e]}computeSize(){return[process.stdout.columns,process.stdout.rows]}}const De=/%([bc]){([^}]*)}/g;function $e(t,e){let i=[],n=0;t.replace(De,(function(e,o,r,s){let l=t.substring(n,s);return l.length&&i.push({type:0,value:l}),i.push({type:"c"==o?2:3,value:r.trim()}),n=s+e.length,""}));let o=t.substring(n);return o.length&&i.push({type:0,value:o}),function(t,e){e||(e=1/0);let i=0,n=0,o=-1;for(;i<t.length;){let r=t[i];if(1==r.type&&(n=0,o=-1),0!=r.type){i++;continue}for(;0==n&&" "==r.value.charAt(0);)r.value=r.value.substring(1);let s=r.value.indexOf("\n");if(-1!=s){r.value=Ne(t,i,s,!0);let e=r.value.split("");for(;e.length&&" "==e[e.length-1];)e.pop();r.value=e.join("")}if(r.value.length){if(n+r.value.length>e){let s=-1;for(;;){let t=r.value.indexOf(" ",s+1);if(-1==t)break;if(n+t>e)break;s=t}if(-1!=s)r.value=Ne(t,i,s,!0);else if(-1!=o){let e=t[o],n=e.value.lastIndexOf(" ");e.value=Ne(t,o,n,!0),i=o}else r.value=Ne(t,i,e-n,!1)}else n+=r.value.length,-1!=r.value.indexOf(" ")&&(o=i);i++}else t.splice(i,1)}t.push({type:1});let r=null;for(let e=0;e<t.length;e++){let i=t[e];switch(i.type){case 0:r=i;break;case 1:if(r){let t=r.value.split("");for(;t.length&&" "==t[t.length-1];)t.pop();r.value=t.join("")}r=null}}return t.pop(),t}(i,e)}function Ne(t,e,i,n){let o={type:1},r={type:0,value:t[e].value.substring(i+(n?1:0))};return t.splice(e+1,0,o,r),t[e].value.substring(0,i)}const Le={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},Fe={hex:ke,rect:Ce,tile:Se,"tile-gl":Te,term:We},ze={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};(()=>{class t{constructor(t={}){this._data={},this._dirty=!1,this._options={},t=Object.assign({},ze,t),this.setOptions(t),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}DEBUG(t,e,i){let n=[this._options.bg,this._options.fg];this.draw(t,e,null,null,n[i%n.length])}clear(){this._data={},this._dirty=!0}setOptions(t){if(Object.assign(this._options,t),t.width||t.height||t.fontSize||t.fontFamily||t.spacing||t.layout){if(t.layout){let e=Fe[t.layout];this._backend=new e}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(t,e){return this._backend.computeSize(t,e)}computeFontSize(t,e){return this._backend.computeFontSize(t,e)}computeTileSize(t,e){return[Math.floor(t/this._options.width),Math.floor(e/this._options.height)]}eventToPosition(t){let e,i;return"touches"in t?(e=t.touches[0].clientX,i=t.touches[0].clientY):(e=t.clientX,i=t.clientY),this._backend.eventToPosition(e,i)}draw(t,e,i,n,o){n||(n=this._options.fg),o||(o=this._options.bg);let r=`${t},${e}`;this._data[r]=[t,e,i,n,o],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[r]=!0)}drawText(t,e,i,n){let o=null,r=null,s=t,l=e,a=1;n||(n=this._options.width-t);let h=$e(i,n);for(;h.length;){let e=h.shift();switch(e.type){case 0:let i=!1,n=!1,h=!1,c=!1;for(let t=0;t<e.value.length;t++){let a=e.value.charCodeAt(t),u=e.value.charAt(t);if("term"===this._options.layout){let t=a>>8;if(17===t||t>=46&&t<=159||t>=172&&t<=215||a>=43360&&a<=43391){this.draw(s+0,l,u,o,r),this.draw(s+1,l,"\t",o,r),s+=2;continue}}h=a>65280&&a<65377||a>65500&&a<65512||a>65518,i=32==u.charCodeAt(0)||12288==u.charCodeAt(0),!c||h||i||s++,h&&!n&&s++,this.draw(s++,l,u,o,r),n=i,c=h}break;case 2:o=e.value||null;break;case 3:r=e.value||null;break;case 1:s=t,l++,a++}}return a}_tick(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty){this._backend.clear();for(let t in this._data)this._draw(t,!1)}else for(let t in this._dirty)this._draw(t,!0);this._dirty=!1}}_draw(t,e){let i=this._data[t];i[4]!=this._options.bg&&(e=!0),this._backend.draw(i,e)}}t.Rect=Ce,t.Hex=ke,t.Tile=Se,t.TileGL=Te,t.Term=We})();class Xe{constructor(t=80,e=25){this._width=t,this._height=e}_fillMap(t){let e=[];for(let i=0;i<this._width;i++){e.push([]);for(let n=0;n<this._height;n++)e[i].push(t)}return e}}class je extends Xe{constructor(t,e){super(t,e),this._rooms=[],this._corridors=[]}getRooms(){return this._rooms}getCorridors(){return this._corridors}}class Be{}class He extends Be{constructor(t,e,i,n,o,r){super(),this._x1=t,this._y1=e,this._x2=i,this._y2=n,this._doors={},void 0!==o&&void 0!==r&&this.addDoor(o,r)}static createRandomAt(t,e,i,n,o){let r=o.roomWidth[0],s=o.roomWidth[1],l=ve.getUniformInt(r,s);r=o.roomHeight[0],s=o.roomHeight[1];let a=ve.getUniformInt(r,s);if(1==i){let i=e-Math.floor(ve.getUniform()*a);return new this(t+1,i,t+l,i+a-1,t,e)}if(-1==i){let i=e-Math.floor(ve.getUniform()*a);return new this(t-l,i,t-1,i+a-1,t,e)}if(1==n){let i=t-Math.floor(ve.getUniform()*l);return new this(i,e+1,i+l-1,e+a,t,e)}if(-1==n){let i=t-Math.floor(ve.getUniform()*l);return new this(i,e-a,i+l-1,e-1,t,e)}throw new Error("dx or dy must be 1 or -1")}static createRandomCenter(t,e,i){let n=i.roomWidth[0],o=i.roomWidth[1],r=ve.getUniformInt(n,o);n=i.roomHeight[0],o=i.roomHeight[1];let s=ve.getUniformInt(n,o),l=t-Math.floor(ve.getUniform()*r),a=e-Math.floor(ve.getUniform()*s);return new this(l,a,l+r-1,a+s-1)}static createRandom(t,e,i){let n=i.roomWidth[0],o=i.roomWidth[1],r=ve.getUniformInt(n,o);n=i.roomHeight[0],o=i.roomHeight[1];let s=ve.getUniformInt(n,o),l=t-r-1,a=e-s-1,h=1+Math.floor(ve.getUniform()*l),c=1+Math.floor(ve.getUniform()*a);return new this(h,c,h+r-1,c+s-1)}addDoor(t,e){return this._doors[t+","+e]=1,this}getDoors(t){for(let e in this._doors){let i=e.split(",");t(parseInt(i[0]),parseInt(i[1]))}return this}clearDoors(){return this._doors={},this}addDoors(t){let e=this._x1-1,i=this._x2+1,n=this._y1-1,o=this._y2+1;for(let r=e;r<=i;r++)for(let s=n;s<=o;s++)r!=e&&r!=i&&s!=n&&s!=o||t(r,s)||this.addDoor(r,s);return this}debug(){console.log("room",this._x1,this._y1,this._x2,this._y2)}isValid(t,e){let i=this._x1-1,n=this._x2+1,o=this._y1-1,r=this._y2+1;for(let s=i;s<=n;s++)for(let l=o;l<=r;l++)if(s==i||s==n||l==o||l==r){if(!t(s,l))return!1}else if(!e(s,l))return!1;return!0}create(t){let e=this._x1-1,i=this._x2+1,n=this._y1-1,o=this._y2+1,r=0;for(let s=e;s<=i;s++)for(let l=n;l<=o;l++)r=s+","+l in this._doors?2:s==e||s==i||l==n||l==o?1:0,t(s,l,r)}getCenter(){return[Math.round((this._x1+this._x2)/2),Math.round((this._y1+this._y2)/2)]}getLeft(){return this._x1}getRight(){return this._x2}getTop(){return this._y1}getBottom(){return this._y2}}class Ye extends Be{constructor(t,e,i,n){super(),this._startX=t,this._startY=e,this._endX=i,this._endY=n,this._endsWithAWall=!0}static createRandomAt(t,e,i,n,o){let r=o.corridorLength[0],s=o.corridorLength[1],l=ve.getUniformInt(r,s);return new this(t,e,t+i*l,e+n*l)}debug(){console.log("corridor",this._startX,this._startY,this._endX,this._endY)}isValid(t,e){let i=this._startX,n=this._startY,o=this._endX-i,r=this._endY-n,s=1+Math.max(Math.abs(o),Math.abs(r));o&&(o/=Math.abs(o)),r&&(r/=Math.abs(r));let l=r,a=-o,h=!0;for(let c=0;c<s;c++){let u=i+c*o,f=n+c*r;if(e(u,f)||(h=!1),t(u+l,f+a)||(h=!1),t(u-l,f-a)||(h=!1),!h){s=c,this._endX=u-o,this._endY=f-r;break}}if(0==s)return!1;if(1==s&&t(this._endX+o,this._endY+r))return!1;let c=!t(this._endX+o+l,this._endY+r+a),u=!t(this._endX+o-l,this._endY+r-a);return this._endsWithAWall=t(this._endX+o,this._endY+r),!c&&!u||!this._endsWithAWall}create(t){let e=this._startX,i=this._startY,n=this._endX-e,o=this._endY-i,r=1+Math.max(Math.abs(n),Math.abs(o));n&&(n/=Math.abs(n)),o&&(o/=Math.abs(o));for(let s=0;s<r;s++){t(e+s*n,i+s*o,0)}return!0}createPriorityWalls(t){if(!this._endsWithAWall)return;let e=this._startX,i=this._startY,n=this._endX-e,o=this._endY-i;n&&(n/=Math.abs(n)),o&&(o/=Math.abs(o));let r=o,s=-n;t(this._endX+n,this._endY+o),t(this._endX+r,this._endY+s),t(this._endX-r,this._endY-s)}}const Ve={room:He,corridor:Ye};function Ge(t,e,i){i[e[t+1]]=i[t],e[i[t]]=e[t+1],i[t]=t+1,e[t+1]=t}function qe(t,e,i){i[e[t]]=i[t],e[i[t]]=e[t],i[t]=t,e[t]=t}const Ke={Arena:class extends Xe{create(t){let e=this._width-1,i=this._height-1;for(let n=0;n<=e;n++)for(let o=0;o<=i;o++){t(n,o,n&&o&&n<e&&o<i?0:1)}return this}},Uniform:class extends je{constructor(t,e,i){super(t,e),this._options={roomWidth:[3,9],roomHeight:[3,5],roomDugPercentage:.1,timeLimit:1e3},Object.assign(this._options,i),this._map=[],this._dug=0,this._roomAttempts=20,this._corridorAttempts=20,this._connected=[],this._unconnected=[],this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this)}create(t){let e=Date.now();for(;;){if(Date.now()-e>this._options.timeLimit)return null;if(this._map=this._fillMap(1),this._dug=0,this._rooms=[],this._unconnected=[],this._generateRooms(),!(this._rooms.length<2)&&this._generateCorridors())break}if(t)for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,this._map[e][i]);return this}_generateRooms(){let t,e=this._width-2,i=this._height-2;do{if(t=this._generateRoom(),this._dug/(e*i)>this._options.roomDugPercentage)break}while(t)}_generateRoom(){let t=0;for(;t<this._roomAttempts;){t++;let e=He.createRandom(this._width,this._height,this._options);if(e.isValid(this._isWallCallback,this._canBeDugCallback))return e.create(this._digCallback),this._rooms.push(e),e}return null}_generateCorridors(){let t=0;for(;t<this._corridorAttempts;){t++,this._corridors=[],this._map=this._fillMap(1);for(let t=0;t<this._rooms.length;t++){let e=this._rooms[t];e.clearDoors(),e.create(this._digCallback)}for(this._unconnected=ve.shuffle(this._rooms.slice()),this._connected=[],this._unconnected.length&&this._connected.push(this._unconnected.pop());;){let t=ve.getItem(this._connected);if(!t)break;let e=this._closestRoom(this._unconnected,t);if(!e)break;let i=this._closestRoom(this._connected,e);if(!i)break;if(!this._connectRooms(e,i))break;if(!this._unconnected.length)return!0}}return!1}_closestRoom(t,e){let i=1/0,n=e.getCenter(),o=null;for(let e=0;e<t.length;e++){let r=t[e],s=r.getCenter(),l=s[0]-n[0],a=s[1]-n[1],h=l*l+a*a;h<i&&(i=h,o=r)}return o}_connectRooms(t,e){let i,n,o,r,s,l,a,h=t.getCenter(),c=e.getCenter(),u=c[0]-h[0],f=c[1]-h[1];if(Math.abs(u)<Math.abs(f)?(o=f>0?2:0,r=(o+2)%4,s=e.getLeft(),l=e.getRight(),a=0):(o=u>0?1:3,r=(o+2)%4,s=e.getTop(),l=e.getBottom(),a=1),i=this._placeInWall(t,o),!i)return!1;if(i[a]>=s&&i[a]<=l){n=i.slice();let t=0;switch(r){case 0:t=e.getTop()-1;break;case 1:t=e.getRight()+1;break;case 2:t=e.getBottom()+1;break;case 3:t=e.getLeft()-1}n[(a+1)%2]=t,this._digLine([i,n])}else if(i[a]<s-1||i[a]>l+1){let t=i[a]-c[a],o=0;switch(r){case 0:case 1:o=t<0?3:1;break;case 2:case 3:o=t<0?1:3}if(r=(r+o)%4,n=this._placeInWall(e,r),!n)return!1;let s=[0,0];s[a]=i[a];let l=(a+1)%2;s[l]=n[l],this._digLine([i,s,n])}else{let t=(a+1)%2;if(n=this._placeInWall(e,r),!n)return!1;let o=Math.round((n[t]+i[t])/2),s=[0,0],l=[0,0];s[a]=i[a],s[t]=o,l[a]=n[a],l[t]=o,this._digLine([i,s,l,n])}return t.addDoor(i[0],i[1]),e.addDoor(n[0],n[1]),a=this._unconnected.indexOf(t),-1!=a&&(this._unconnected.splice(a,1),this._connected.push(t)),a=this._unconnected.indexOf(e),-1!=a&&(this._unconnected.splice(a,1),this._connected.push(e)),!0}_placeInWall(t,e){let i=[0,0],n=[0,0],o=0;switch(e){case 0:n=[1,0],i=[t.getLeft(),t.getTop()-1],o=t.getRight()-t.getLeft()+1;break;case 1:n=[0,1],i=[t.getRight()+1,t.getTop()],o=t.getBottom()-t.getTop()+1;break;case 2:n=[1,0],i=[t.getLeft(),t.getBottom()+1],o=t.getRight()-t.getLeft()+1;break;case 3:n=[0,1],i=[t.getLeft()-1,t.getTop()],o=t.getBottom()-t.getTop()+1}let r=[],s=-2;for(let t=0;t<o;t++){let e=i[0]+t*n[0],o=i[1]+t*n[1];r.push(null),1==this._map[e][o]?s!=t-1&&(r[t]=[e,o]):(s=t,t&&(r[t-1]=null))}for(let t=r.length-1;t>=0;t--)r[t]||r.splice(t,1);return r.length?ve.getItem(r):null}_digLine(t){for(let e=1;e<t.length;e++){let i=t[e-1],n=t[e],o=new Ye(i[0],i[1],n[0],n[1]);o.create(this._digCallback),this._corridors.push(o)}}_digCallback(t,e,i){this._map[t][e]=i,0==i&&this._dug++}_isWallCallback(t,e){return!(t<0||e<0||t>=this._width||e>=this._height)&&1==this._map[t][e]}_canBeDugCallback(t,e){return!(t<1||e<1||t+1>=this._width||e+1>=this._height)&&1==this._map[t][e]}},Cellular:class extends Xe{constructor(t,e,i={}){super(t,e),this._options={born:[5,6,7,8],survive:[4,5,6,7,8],topology:8},this.setOptions(i),this._dirs=Le[this._options.topology],this._map=this._fillMap(0)}randomize(t){for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)this._map[e][i]=ve.getUniform()<t?1:0;return this}setOptions(t){Object.assign(this._options,t)}set(t,e,i){this._map[t][e]=i}create(t){let e=this._fillMap(0),i=this._options.born,n=this._options.survive;for(let t=0;t<this._height;t++){let o=1,r=0;6==this._options.topology&&(o=2,r=t%2);for(let s=r;s<this._width;s+=o){let o=this._map[s][t],r=this._getNeighbors(s,t);o&&-1!=n.indexOf(r)?e[s][t]=1:o||-1==i.indexOf(r)||(e[s][t]=1)}}this._map=e,t&&this._serviceCallback(t)}_serviceCallback(t){for(let e=0;e<this._height;e++){let i=1,n=0;6==this._options.topology&&(i=2,n=e%2);for(let o=n;o<this._width;o+=i)t(o,e,this._map[o][e])}}_getNeighbors(t,e){let i=0;for(let n=0;n<this._dirs.length;n++){let o=this._dirs[n],r=t+o[0],s=e+o[1];r<0||r>=this._width||s<0||s>=this._height||(i+=1==this._map[r][s]?1:0)}return i}connect(t,e,i){e||(e=0);let n=[],o={},r=1,s=[0,0];6==this._options.topology&&(r=2,s=[0,1]);for(let t=0;t<this._height;t++)for(let i=s[t%2];i<this._width;i+=r)if(this._freeSpace(i,t,e)){let e=[i,t];o[this._pointKey(e)]=e,n.push([i,t])}let l=n[ve.getUniformInt(0,n.length-1)],a=this._pointKey(l),h={};for(h[a]=l,delete o[a],this._findConnected(h,o,[l],!1,e);Object.keys(o).length>0;){let t=this._getFromTo(h,o),n=t[0],r=t[1],s={};s[this._pointKey(n)]=n,this._findConnected(s,o,[n],!0,e),(6==this._options.topology?this._tunnelToConnected6:this._tunnelToConnected).call(this,r,n,h,o,e,i);for(let t in s){let i=s[t];this._map[i[0]][i[1]]=e,h[t]=i,delete o[t]}}t&&this._serviceCallback(t)}_getFromTo(t,e){let i,n=[0,0],o=[0,0],r=Object.keys(t),s=Object.keys(e);for(let l=0;l<5;l++){if(r.length<s.length){let i=r;o=t[i[ve.getUniformInt(0,i.length-1)]],n=this._getClosest(o,e)}else{let i=s;n=e[i[ve.getUniformInt(0,i.length-1)]],o=this._getClosest(n,t)}if(i=(n[0]-o[0])*(n[0]-o[0])+(n[1]-o[1])*(n[1]-o[1]),i<64)break}return[n,o]}_getClosest(t,e){let i=null,n=null;for(let o in e){let r=e[o],s=(r[0]-t[0])*(r[0]-t[0])+(r[1]-t[1])*(r[1]-t[1]);(null==n||s<n)&&(n=s,i=r)}return i}_findConnected(t,e,i,n,o){for(;i.length>0;){let r,s=i.splice(0,1)[0];r=6==this._options.topology?[[s[0]+2,s[1]],[s[0]+1,s[1]-1],[s[0]-1,s[1]-1],[s[0]-2,s[1]],[s[0]-1,s[1]+1],[s[0]+1,s[1]+1]]:[[s[0]+1,s[1]],[s[0]-1,s[1]],[s[0],s[1]+1],[s[0],s[1]-1]];for(let s=0;s<r.length;s++){let l=this._pointKey(r[s]);null==t[l]&&this._freeSpace(r[s][0],r[s][1],o)&&(t[l]=r[s],n||delete e[l],i.push(r[s]))}}}_tunnelToConnected(t,e,i,n,o,r){let s,l;e[0]<t[0]?(s=e,l=t):(s=t,l=e);for(let t=s[0];t<=l[0];t++){this._map[t][s[1]]=o;let e=[t,s[1]],r=this._pointKey(e);i[r]=e,delete n[r]}r&&s[0]<l[0]&&r(s,[l[0],s[1]]);let a=l[0];e[1]<t[1]?(s=e,l=t):(s=t,l=e);for(let t=s[1];t<l[1];t++){this._map[a][t]=o;let e=[a,t],r=this._pointKey(e);i[r]=e,delete n[r]}r&&s[1]<l[1]&&r([l[0],s[1]],[l[0],l[1]])}_tunnelToConnected6(t,e,i,n,o,r){let s,l;e[0]<t[0]?(s=e,l=t):(s=t,l=e);let a=s[0],h=s[1];for(;a!=l[0]||h!=l[1];){let t=2;h<l[1]?(h++,t=1):h>l[1]&&(h--,t=1),a<l[0]?a+=t:a>l[0]||l[1]%2?a-=t:a+=t,this._map[a][h]=o;let e=[a,h],r=this._pointKey(e);i[r]=e,delete n[r]}r&&r(e,t)}_freeSpace(t,e,i){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._map[t][e]==i}_pointKey(t){return t[0]+"."+t[1]}},Digger:class extends je{constructor(t,e,i={}){super(t,e),this._options=Object.assign({roomWidth:[3,9],roomHeight:[3,5],corridorLength:[3,10],dugPercentage:.2,timeLimit:1e3},i),this._features={room:4,corridor:4},this._map=[],this._featureAttempts=20,this._walls={},this._dug=0,this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this),this._priorityWallCallback=this._priorityWallCallback.bind(this)}create(t){this._rooms=[],this._corridors=[],this._map=this._fillMap(1),this._walls={},this._dug=0;let e=(this._width-2)*(this._height-2);this._firstRoom();let i,n=Date.now();do{if(i=0,Date.now()-n>this._options.timeLimit)break;let t=this._findWall();if(!t)break;let e=t.split(","),o=parseInt(e[0]),r=parseInt(e[1]),s=this._getDiggingDirection(o,r);if(!s)continue;let l=0;do{if(l++,this._tryFeature(o,r,s[0],s[1])){this._removeSurroundingWalls(o,r),this._removeSurroundingWalls(o-s[0],r-s[1]);break}}while(l<this._featureAttempts);for(let t in this._walls)this._walls[t]>1&&i++}while(this._dug/e<this._options.dugPercentage||i);if(this._addDoors(),t)for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,this._map[e][i]);return this._walls={},this._map=[],this}_digCallback(t,e,i){0==i||2==i?(this._map[t][e]=0,this._dug++):this._walls[t+","+e]=1}_isWallCallback(t,e){return!(t<0||e<0||t>=this._width||e>=this._height)&&1==this._map[t][e]}_canBeDugCallback(t,e){return!(t<1||e<1||t+1>=this._width||e+1>=this._height)&&1==this._map[t][e]}_priorityWallCallback(t,e){this._walls[t+","+e]=2}_firstRoom(){let t=Math.floor(this._width/2),e=Math.floor(this._height/2),i=He.createRandomCenter(t,e,this._options);this._rooms.push(i),i.create(this._digCallback)}_findWall(){let t=[],e=[];for(let i in this._walls){2==this._walls[i]?e.push(i):t.push(i)}let i=e.length?e:t;if(!i.length)return null;let n=ve.getItem(i.sort());return delete this._walls[n],n}_tryFeature(t,e,i,n){let o=ve.getWeightedValue(this._features),r=Ve[o].createRandomAt(t,e,i,n,this._options);return!!r.isValid(this._isWallCallback,this._canBeDugCallback)&&(r.create(this._digCallback),r instanceof He&&this._rooms.push(r),r instanceof Ye&&(r.createPriorityWalls(this._priorityWallCallback),this._corridors.push(r)),!0)}_removeSurroundingWalls(t,e){let i=Le[4];for(let n=0;n<i.length;n++){let o=i[n],r=t+o[0],s=e+o[1];delete this._walls[r+","+s],r=t+2*o[0],s=e+2*o[1],delete this._walls[r+","+s]}}_getDiggingDirection(t,e){if(t<=0||e<=0||t>=this._width-1||e>=this._height-1)return null;let i=null,n=Le[4];for(let o=0;o<n.length;o++){let r=n[o],s=t+r[0],l=e+r[1];if(!this._map[s][l]){if(i)return null;i=r}}return i?[-i[0],-i[1]]:null}_addDoors(){let t=this._map;function e(e,i){return 1==t[e][i]}for(let t=0;t<this._rooms.length;t++){let i=this._rooms[t];i.clearDoors(),i.addDoors(e)}}},EllerMaze:class extends Xe{create(t){let e,i=this._fillMap(1),n=Math.ceil((this._width-2)/2),o=9/24,r=[],s=[];for(let t=0;t<n;t++)r.push(t),s.push(t);for(r.push(n-1),e=1;e+3<this._height;e+=2)for(let t=0;t<n;t++){let n=2*t+1,l=e;i[n][l]=0,t!=r[t+1]&&ve.getUniform()>o&&(Ge(t,r,s),i[n+1][l]=0),t!=r[t]&&ve.getUniform()>o?qe(t,r,s):i[n][l+1]=0}for(let t=0;t<n;t++){let n=2*t+1,l=e;i[n][l]=0,t!=r[t+1]&&(t==r[t]||ve.getUniform()>o)&&(Ge(t,r,s),i[n+1][l]=0),qe(t,r,s)}for(let e=0;e<this._width;e++)for(let n=0;n<this._height;n++)t(e,n,i[e][n]);return this}},DividedMaze:class extends Xe{constructor(){super(...arguments),this._stack=[],this._map=[]}create(t){let e=this._width,i=this._height;this._map=[];for(let t=0;t<e;t++){this._map.push([]);for(let n=0;n<i;n++){let o=0==t||0==n||t+1==e||n+1==i;this._map[t].push(o?1:0)}}this._stack=[[1,1,e-2,i-2]],this._process();for(let n=0;n<e;n++)for(let e=0;e<i;e++)t(n,e,this._map[n][e]);return this._map=[],this}_process(){for(;this._stack.length;){let t=this._stack.shift();this._partitionRoom(t)}}_partitionRoom(t){let e=[],i=[];for(let i=t[0]+1;i<t[2];i++){let n=this._map[i][t[1]-1],o=this._map[i][t[3]+1];!n||!o||i%2||e.push(i)}for(let e=t[1]+1;e<t[3];e++){let n=this._map[t[0]-1][e],o=this._map[t[2]+1][e];!n||!o||e%2||i.push(e)}if(!e.length||!i.length)return;let n=ve.getItem(e),o=ve.getItem(i);this._map[n][o]=1;let r=[],s=[];r.push(s);for(let e=t[0];e<n;e++)this._map[e][o]=1,e%2&&s.push([e,o]);s=[],r.push(s);for(let e=n+1;e<=t[2];e++)this._map[e][o]=1,e%2&&s.push([e,o]);s=[],r.push(s);for(let e=t[1];e<o;e++)this._map[n][e]=1,e%2&&s.push([n,e]);s=[],r.push(s);for(let e=o+1;e<=t[3];e++)this._map[n][e]=1,e%2&&s.push([n,e]);let l=ve.getItem(r);for(let t=0;t<r.length;t++){let e=r[t];if(e==l)continue;let i=ve.getItem(e);this._map[i[0]][i[1]]=0}this._stack.push([t[0],t[1],n-1,o-1]),this._stack.push([n+1,t[1],t[2],o-1]),this._stack.push([t[0],o+1,n-1,t[3]]),this._stack.push([n+1,o+1,t[2],t[3]])}},IceyMaze:class extends Xe{constructor(t,e,i=0){super(t,e),this._regularity=i,this._map=[]}create(t){let e=this._width,i=this._height,n=this._fillMap(1);e-=e%2?1:2,i-=i%2?1:2;let o=0,r=0,s=0,l=0,a=0,h=!1,c=[[0,0],[0,0],[0,0],[0,0]];do{if(o=1+2*Math.floor(ve.getUniform()*(e-1)/2),r=1+2*Math.floor(ve.getUniform()*(i-1)/2),a||(n[o][r]=0),!n[o][r]){this._randomize(c);do{0==Math.floor(ve.getUniform()*(this._regularity+1))&&this._randomize(c),h=!0;for(let t=0;t<4;t++)if(s=o+2*c[t][0],l=r+2*c[t][1],this._isFree(n,s,l,e,i)){n[s][l]=0,n[o+c[t][0]][r+c[t][1]]=0,o=s,r=l,h=!1,a++;break}}while(!h)}}while(a+1<e*i/4);for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,n[e][i]);return this._map=[],this}_randomize(t){for(let e=0;e<4;e++)t[e][0]=0,t[e][1]=0;switch(Math.floor(4*ve.getUniform())){case 0:t[0][0]=-1,t[1][0]=1,t[2][1]=-1,t[3][1]=1;break;case 1:t[3][0]=-1,t[2][0]=1,t[1][1]=-1,t[0][1]=1;break;case 2:t[2][0]=-1,t[3][0]=1,t[0][1]=-1,t[1][1]=1;break;case 3:t[1][0]=-1,t[0][0]=1,t[3][1]=-1,t[2][1]=1}}_isFree(t,e,i,n,o){return!(e<1||i<1||e>=n||i>=o)&&t[e][i]}},Rogue:class extends Xe{constructor(t,e,i){super(t,e),this.map=[],this.rooms=[],this.connectedCells=[],(i=Object.assign({cellWidth:3,cellHeight:3},i)).hasOwnProperty("roomWidth")||(i.roomWidth=this._calculateRoomSize(this._width,i.cellWidth)),i.hasOwnProperty("roomHeight")||(i.roomHeight=this._calculateRoomSize(this._height,i.cellHeight)),this._options=i}create(t){if(this.map=this._fillMap(1),this.rooms=[],this.connectedCells=[],this._initRooms(),this._connectRooms(),this._connectUnconnectedRooms(),this._createRandomRoomConnections(),this._createRooms(),this._createCorridors(),t)for(let e=0;e<this._width;e++)for(let i=0;i<this._height;i++)t(e,i,this.map[e][i]);return this}_calculateRoomSize(t,e){let i=Math.floor(t/e*.8),n=Math.floor(t/e*.25);return n<2&&(n=2),i<2&&(i=2),[n,i]}_initRooms(){for(let t=0;t<this._options.cellWidth;t++){this.rooms.push([]);for(let e=0;e<this._options.cellHeight;e++)this.rooms[t].push({x:0,y:0,width:0,height:0,connections:[],cellx:t,celly:e})}}_connectRooms(){let t,e,i,n,o,r,s=ve.getUniformInt(0,this._options.cellWidth-1),l=ve.getUniformInt(0,this._options.cellHeight-1),a=!1;do{r=[0,2,4,6],r=ve.shuffle(r);do{if(a=!1,t=r.pop(),e=s+Le[8][t][0],i=l+Le[8][t][1],!(e<0||e>=this._options.cellWidth||i<0||i>=this._options.cellHeight)){if(n=this.rooms[s][l],n.connections.length>0&&n.connections[0][0]==e&&n.connections[0][1]==i)break;o=this.rooms[e][i],0==o.connections.length&&(o.connections.push([s,l]),this.connectedCells.push([e,i]),s=e,l=i,a=!0)}}while(r.length>0&&0==a)}while(r.length>0)}_connectUnconnectedRooms(){let t,e,i,n=this._options.cellWidth,o=this._options.cellHeight;this.connectedCells=ve.shuffle(this.connectedCells);for(let r=0;r<this._options.cellWidth;r++)for(let s=0;s<this._options.cellHeight;s++)if(t=this.rooms[r][s],0==t.connections.length){let l=[0,2,4,6];l=ve.shuffle(l),i=!1;do{let t=l.pop(),a=r+Le[8][t][0],h=s+Le[8][t][1];if(!(a<0||a>=n||h<0||h>=o)){if(e=this.rooms[a][h],i=!0,0==e.connections.length)break;for(let t=0;t<e.connections.length;t++)if(e.connections[t][0]==r&&e.connections[t][1]==s){i=!1;break}if(i)break}}while(l.length);i?t.connections.push([e.cellx,e.celly]):console.log("-- Unable to connect room.")}}_createRandomRoomConnections(){}_createRooms(){let t,e,i,n,o,r=this._width,s=this._height,l=this._options.cellWidth,a=this._options.cellHeight,h=Math.floor(this._width/l),c=Math.floor(this._height/a),u=this._options.roomWidth,f=this._options.roomHeight;for(let d=0;d<l;d++)for(let l=0;l<a;l++){if(i=h*d,n=c*l,0==i&&(i=1),0==n&&(n=1),t=ve.getUniformInt(u[0],u[1]),e=ve.getUniformInt(f[0],f[1]),l>0)for(o=this.rooms[d][l-1];n-(o.y+o.height)<3;)n++;if(d>0)for(o=this.rooms[d-1][l];i-(o.x+o.width)<3;)i++;let a=Math.round(ve.getUniformInt(0,h-t)/2),p=Math.round(ve.getUniformInt(0,c-e)/2);for(;i+a+t>=r;)a?a--:t--;for(;n+p+e>=s;)p?p--:e--;i+=a,n+=p,this.rooms[d][l].x=i,this.rooms[d][l].y=n,this.rooms[d][l].width=t,this.rooms[d][l].height=e;for(let o=i;o<i+t;o++)for(let t=n;t<n+e;t++)this.map[o][t]=0}}_getWallPosition(t,e){let i,n,o;return 1==e||3==e?(i=ve.getUniformInt(t.x+1,t.x+t.width-2),1==e?(n=t.y-2,o=n+1):(n=t.y+t.height+1,o=n-1),this.map[i][o]=0):(n=ve.getUniformInt(t.y+1,t.y+t.height-2),2==e?(i=t.x+t.width+1,o=i-1):(i=t.x-2,o=i+1),this.map[o][n]=0),[i,n]}_drawCorridor(t,e){let i,n,o,r,s=e[0]-t[0],l=e[1]-t[1],a=t[0],h=t[1],c=[],u=Math.abs(s),f=Math.abs(l),d=ve.getUniform(),p=d,g=1-d;for(n=s>0?2:6,o=l>0?4:0,u<f?(i=Math.ceil(f*p),c.push([o,i]),c.push([n,u]),i=Math.floor(f*g),c.push([o,i])):(i=Math.ceil(u*p),c.push([n,i]),c.push([o,f]),i=Math.floor(u*g),c.push([n,i])),this.map[a][h]=0;c.length>0;)for(r=c.pop();r[1]>0;)a+=Le[8][r[0]][0],h+=Le[8][r[0]][1],this.map[a][h]=0,r[1]=r[1]-1}_createCorridors(){let t,e,i,n,o,r=this._options.cellWidth,s=this._options.cellHeight;for(let l=0;l<r;l++)for(let r=0;r<s;r++){t=this.rooms[l][r];for(let r=0;r<t.connections.length;r++)e=t.connections[r],i=this.rooms[e[0]][e[1]],i.cellx>t.cellx?(n=2,o=4):i.cellx<t.cellx?(n=4,o=2):i.celly>t.celly?(n=3,o=1):(n=1,o=3),this._drawCorridor(this._getWallPosition(t,n),this._getWallPosition(i,o))}}}};Math.sqrt(3),Math.sqrt(3);var Qe=[];new Ke.Cellular(30,30).randomize(.2).create((function(t,e,i){Qe[e]||(Qe[e]=[]),Qe[e][t]=i})),new Ke.Arena(30,30).create((function(t,e,i){Qe[e]||(Qe[e]=[]),Qe[e][t]=i||Qe[e][t]}));const Ze={levelMap:Qe};function Je(t,e){return t===e}function ti(t,e,i){if(null===e||null===i||e.length!==i.length)return!1;for(var n=e.length,o=0;o<n;o++)if(!t(e[o],i[o]))return!1;return!0}function ei(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every((function(t){return"function"==typeof t}))){var i=e.map((function(t){return typeof t})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+i+"]")}return e}var ii=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];var r=0,s=n.pop(),l=ei(n),a=t.apply(void 0,[function(){return r++,s.apply(null,arguments)}].concat(i)),h=t((function(){for(var t=[],e=l.length,i=0;i<e;i++)t.push(l[i].apply(null,arguments));return a.apply(null,t)}));return h.resultFunc=s,h.dependencies=l,h.recomputations=function(){return r},h.resetRecomputations=function(){return r=0},h}}((function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Je,i=null,n=null;return function(){return ti(e,i,arguments)||(n=t.apply(null,arguments)),i=arguments,n}}));class ni{constructor(t,e){this.position=t,this.range=e}}class oi{constructor(t,e){this.x=t,this.y=e}}class ri extends oi{constructor(t,e){super(t,e),this.x=t,this.y=e}}class si{constructor(t,e,i,n,o){this.d=0,this.p1=new ri(t,e),this.p2=new ri(i,n),this.p1.segment=this,this.p2.segment=this,this.wall=o}}class li{constructor(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}getCorners(){return{nw:new oi(this.x,this.y),sw:new oi(this.x,this.y+this.height),ne:new oi(this.x+this.width,this.y),se:new oi(this.x+this.width,this.y+this.height)}}getCornerSegments(){const{nw:t,sw:e,ne:i,se:n}=this.getCorners();return[new si(t.x,t.y,i.x,i.y,{x:0,y:0,wallType:"idk"}),new si(t.x,t.y,e.x,e.y,{x:0,y:0,wallType:"idk"}),new si(i.x,i.y,n.x,n.y,{x:0,y:0,wallType:"idk"}),new si(e.x,e.y,n.x,n.y,{x:0,y:0,wallType:"idk"})]}}const ai=(t,e)=>{const{x:i,y:n}=t,o=.5*(e.p1.x+e.p2.x)-i,r=.5*(e.p1.y+e.p2.y)-n;e.d=o*o+r*r,e.p1.angle=Math.atan2(e.p1.y-n,e.p1.x-i),e.p2.angle=Math.atan2(e.p2.y-n,e.p2.x-i)},hi=2*Math.PI,ci=t=>{let e=t.p2.angle-t.p1.angle;e<=-Math.PI&&(e+=hi),e>Math.PI&&(e-=hi),t.p1.beginsSegment=e>0,t.p2.beginsSegment=!t.p1.beginsSegment};function ui(t,e,i){const n=[];for(const e of t.getCornerSegments())n.push(e);for(const t of e)for(const e of t.getCornerSegments())n.push(e);for(const t of i)n.push(t);return n}function fi(t,e){const i=[];for(const n of((t,e)=>{for(const i of e)ai(t,i),ci(i);return e})(e,t))i.push(n.p1,n.p2);return i}function di(t,e,i,n){const o=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/((n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y));return new oi(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))}function pi(t,e){return t.angle>e.angle?1:t.angle<e.angle?-1:!t.beginsSegment&&e.beginsSegment?1:t.beginsSegment&&!e.beginsSegment?-1:0}const gi=(t,e)=>(t.p2.x-t.p1.x)*(e.y-t.p1.y)-(t.p2.y-t.p1.y)*(e.x-t.p1.x)<0,_i=(t,e,i)=>{const n=1-i;return new oi(t.x*n+e.x*i,t.y*n+e.y*i)},mi=(t,e,i)=>{const n=gi(t,_i(e.p1,e.p2,.01)),o=gi(t,_i(e.p2,e.p1,.01)),r=gi(t,i),s=gi(e,_i(t.p1,t.p2,.01)),l=gi(e,_i(t.p2,t.p1,.01)),a=gi(e,i);return s===l&&l!==a||n===o&&o===r},yi=t=>Math.sin(t),vi=t=>Math.cos(t);function bi(t,e,i,n){const o=vi(e),r=yi(e),s=vi(i),l=yi(i),a=t,h=new oi(t.x+o,t.y+r),c=new oi(0,0),u=new oi(0,0);n?(c.x=n.p1.x,c.y=n.p1.y,u.x=n.p2.x,u.y=n.p2.y):(c.x=t.x+200*o,c.y=t.y+200*r,u.x=t.x+200*s,u.y=t.y+200*l);const f=di(c,u,a,h);h.x=t.x+s,h.y=t.y+l;const d=di(c,u,a,h);return n?{first:f,second:d,wall:n.wall}:{first:f,second:d,wall:{x:0,y:0,wallType:"idk"}}}function wi(t,e){const i=t.position,n=[],o=[];let r=0;e.sort(pi);for(let t=0;t<2;t+=1)for(const s of e){const e=n[0];if(s.beginsSegment){let t=0,e=n[t];for(;e&&mi(s.segment,e,i);)t+=1,e=n[t];e?n.splice(t,0,s.segment):n.push(s.segment)}else{const t=n.indexOf(s.segment);t>-1&&n.splice(t,1)}if(e!==n[0]){if(1===t){const t=bi(i,r,s.angle,e);o.push(t)}r=s.angle}}return o}function xi(t){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ki(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ci(t,e){return(Ci=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Si(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ei(t);if(e){var o=Ei(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Mi(this,i)}}function Mi(t,e){return!e||"object"!==xi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ei(t){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ti=function(t,e,i){return(t.x-i.x)*(e.y-i.y)-(e.x-i.x)*(t.y-i.y)},Pi={fudge:5,width:100,height:100,knownMap:[],lightSource:{x:0,y:0},markers:[],menuOpen:!1,mode:"dbg",mouseX:0,mouseY:0,preloadedMap:[],visibility:[],visibleMap:[]},Ri=ii([function(t){return t.preloadedMap},function(t){return t.markers}],(function(t,e){return e.map((function(e){return{x:e.x,y:e.y,triangles:wi(new ni(new oi(e.x,e.y),10),fi(t,{x:e.x,y:e.y}))}}))}));const Ii=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ci(t,e)}(r,t);var e,i,n,o=Si(r);function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,t)).state=Pi,e}return e=r,(i=[{key:"componentDidMount",value:function(){this.resetMapDungeon()}},{key:"resetMapDungeon",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.height,i=[],n=[];new Ke.Uniform(t,e,{}).create((function(t,e,n){n&&(i[e]||(i[e]=[]),i[e][t]=n)})),new Ke.Arena(t,e).create((function(t,e,n){n&&(i[e]||(i[e]=[]),i[e][t]=n)}));var o=[];i.map((function(t,e){o[e]||(o[e]=[]),t.map((function(t,n){1===t&&(o[e][n]={},(e-1<0||1!=i[e-1][n])&&(o[e][n].north=!0),(e+1>i.length-1||1!=i[e+1][n])&&(o[e][n].south=!0),(n-1<0||1!=i[e][n-1])&&(o[e][n].west=!0),(n+1>i[0].length-1||1!=i[e][n+1])&&(o[e][n].east=!0))}))})),o.map((function(t,e){t.map((function(t,i){var o={x:i,y:e,wallType:"foo"};t.north&&n.push(new si(i,e,i+1,e,o)),t.south&&n.push(new si(i,e+1,i+1,e+1,o)),t.west&&n.push(new si(i,e,i,e+1,o)),t.east&&n.push(new si(i+1,e,i+1,e+1,o))}))})),this.setState({preloadedMap:ui(new li(0,0,0,0,{x:0,y:0,wallType:"idk"}),[],n)})}},{key:"onMouseMove",value:function(t){this.setState({mouseX:t.clientX/this.state.fudge,mouseY:t.clientY/this.state.fudge})}},{key:"placeMarker",value:function(t){this.setState({markers:this.state.markers.concat({x:t.clientX/this.state.fudge,y:t.clientY/this.state.fudge})})}},{key:"isInTriangle",value:function(t,e,i){return n=t,o=i,r=e.first,s=e.second,l=Ti(n,o,r),a=Ti(n,r,s),h=Ti(n,s,o),!((l<0||a<0||h<0)&&(l>0||a>0||h>0));var n,o,r,s,l,a,h}},{key:"render",value:function(){var t=this,e=Ri(this.state),i=new ni(new oi(this.state.mouseX,this.state.mouseY),10),n=wi(i,fi(this.state.preloadedMap,i.position)),o=n.reduce((function(e,n){return e.concat(t.state.markers.filter((function(e){return t.isInTriangle(e,n,i.position)})))}),[]),r=[];e.forEach((function(t){t.triangles.forEach((function(t){r[t.wall.y]||(r[t.wall.y]=[]),r[t.wall.y][t.wall.x]=t.wall.wallType}))})),this.state.visibleMap=[],n.forEach((function(e){t.state.knownMap[e.wall.y]||(t.state.knownMap[e.wall.y]=[]),t.state.visibleMap[e.wall.y]||(t.state.visibleMap[e.wall.y]=[]),r[e.wall.y]&&r[e.wall.y][e.wall.x]&&(t.state.knownMap[e.wall.y][e.wall.x]="foo"===e.wall.wallType,t.state.visibleMap[e.wall.y][e.wall.x]="foo"===e.wall.wallType)}));var s=this.state.fudge,l=["fudge","width","height","mode"],a=Object.keys(this.state).filter((function(t){return l.includes(t)})).reduce((function(e,i){return e[i]=t.state[i],e}),{});return qt("div",null,[qt("div",{id:"myNav",className:"overlay",style:this.state.menuOpen?{width:"100%"}:{width:"0%"}},qt("button",{className:"closebtn",onClick:function(e){return t.setState({menuOpen:!1})}},"close"),qt("div",{className:"overlay-content"},qt("h1",null,"Duskers-like experiment #0"),qt("p",null,"Move the mouse to change the position of the camera. Click to place a light source."),qt("button",{onClick:function(e){return t.resetMapDungeon()}},"make a dungeon"),qt("pre",{},JSON.stringify(a,null,2)),qt("br",null),qt("button",{onClick:function(e){return t.setState({knownMap:[]})}},"reset known map"),qt("br",null),qt("div",{onChange:function(e){return t.setState({mode:e.target.value})}},qt("input",{type:"radio",value:"fgwr",name:"mode",onClick:function(e){return t.setState({mode:"fgwr"})}})," Fog of War",qt("input",{type:"radio",value:"dbg",name:"mode",onClick:function(e){return t.setState({mode:"dbg"})}})," Debug"),qt("h2",null,"Credits"),qt("a",{href:"https://github.com/andrienko/2d-visibility/tree/updated-versions"},"https://github.com/andrienko/2d-visibility/tree/updated-versions"),qt("a",{href:"https://www.redblobgames.com/articles/visibility/"},"https://www.redblobgames.com/articles/visibility/"),qt("a",{href:"https://ondras.github.io/rot.js"},"https://ondras.github.io/rot.js"))),qt("button",{id:"menuOpenButton",onClick:function(e){return t.setState({menuOpen:!0})}},"menu"),qt("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",onMouseMove:function(e){return t.onMouseMove(e)},onClick:function(e){return t.placeMarker(e)}},["dbg"===this.state.mode&&n.map((function(t){var e=t.first,n=t.second,o={x1:e.x*s,y1:e.y*s,x2:n.x*s,y2:n.y*s},r=i.position.x*s,l=i.position.y*s;return[qt("line",{x1:r,y1:l,x2:o.x1,y2:o.y1,stroke:"blue"}),qt("line",{x1:r,y1:l,x2:o.x2,y2:o.y2,stroke:"blue"})]})),"dbg"===this.state.mode&&e.map((function(t){return t.triangles.map((function(e){return[qt("line",{x1:t.x*s,y1:t.y*s,x2:e.first.x*s,y2:e.first.y*s,stroke:"yellow"})," ",qt("line",{x1:t.x*s,y1:t.y*s,x2:e.second.x*s,y2:e.second.y*s,stroke:"yellow"})]}))})),this.state.knownMap.map((function(t,e){return t.map((function(t,i){return t?qt("rect",{x:i*s,y:e*s,width:s,height:s,fill:"grey"}):qt("group",null)}))})),this.state.visibleMap.map((function(t,e){return t.map((function(t,i){return t?qt("rect",{x:i*s,y:e*s,width:s,height:s,fill:"black",stroke:"yellow"}):qt("group",null)}))})),o.map((function(t){return qt("circle",{cx:t.x*s,cy:t.y*s,r:4,fill:"yellow",stroke:"yellow"})})),qt("circle",{cx:i.position.x*s,cy:i.position.y*s,r:4,fill:"blue",stroke:"black"})])])}}])&&ki(e.prototype,i),n&&ki(e,n),r}(Bt);var Oi=function(t){return te((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case ce:return ge(ge({},t),{},{INITAILIZED:!0});case ae:return ge(ge({},t),{},{sandwiches:t.sandwiches.filter((function(t,i){return i!==e.payload}))});case ie:return ge(ge({},t),{},{gratuity:Math.max(e.payload,0)});case he:return ge(ge({},t),{},{sandwiches:t.sandwiches.map((function(t){return t.name===e.payload.sandwichName&&(t.toPush=e.payload.ingredientId),t}))});case le:return ge(ge({},t),{},{sandwiches:t.sandwiches.map((function(t,i){return i===e.payload&&(t.recipe.push(t.toPush),t.toPush=""),t}))});case se:return ge(ge({},t),{},{sandwiches:t.sandwiches.map((function(t){return t.name===e.payload&&t.recipe.pop(),t}))});case ne:return ge(ge({},t),{},{sandwiches:t.sandwiches.map((function(t,i){return i===e.payload.index&&(t.name=e.payload.sandwichName),t}))});case ee:return ge(ge({},t),{},{stagedSandwich:"",sandwiches:[].concat(fe(t.sandwiches),[{name:t.stagedSandwich,recipe:[],toPush:""}])});case oe:return ge(ge({},t),{},{stagedSandwich:e.payload});case re:var i=Object.keys(t.orders);return ge(ge({},t),{},{sandwiches:[],orders:ge(ge({},t.orders),{},_e({},Math.max.apply(Math,fe(i.length?i.map((function(t){return parseInt(t)})):[0]))+1,{grandTotal:e.payload,status:"open",sandwiches:t.sandwiches.map((function(t){return{name:t.name,recipe:t.recipe}}))})),ingredients:t.ingredients.map((function(e){return t.sandwiches.forEach((function(t){t.recipe.forEach((function(t){t===e.id&&(e.amount=e.amount-1)}))})),e}))});case ue:var n={};return Object.keys(t.orders).forEach((function(i){n[i]=t.orders[i],i===e.payload&&(n[i].status="closed")})),ge(ge({},t),{},{orders:n});default:return t}}),t)}(Ze);document.addEventListener("DOMContentLoaded",(function(t){var e=document.getElementById("root");Oi.subscribe((function(){e&&Dt(qt(Ii,{storeState:Oi.getState()},""),e)})),Oi.dispatch({type:"INITIALIZE"})}))})()})();